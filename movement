
#include <SFML/Graphics.hpp>
#include<iostream>
#include <SFML/Audio.hpp>

using namespace std;
using namespace sf;
int main()
{
    int randomx = 0, randomy = 0, counter = 0, max = 0, c = 0;
    bool visible = true;
    RenderWindow window(VideoMode(1024, 720), "Snake");
    CircleShape shape;
    shape.setFillColor(Color::Red);
    shape.setRadius(4);
    shape.setOutlineColor(Color::Black);
    shape.setOutlineThickness(2);
    Clock clock, animation_, clock2;
    float deltatime = 0.0;
    enum direction { stop, up, down, right, left };
    direction dir = stop;
    float x = .5, y = .5;
    srand(time(NULL));
    randomx = (rand() % 40) * 20;
    randomy = (rand() % 30) * 20;
    shape.setPosition(randomx, randomy);
    Texture player, target, back, player2;
    Sprite snake(player), apple(target), grass(back), tail(player2);
    player.loadFromFile("./snake.png");
    target.loadFromFile("./snake.png");
    back.loadFromFile("./snake.png");
    player2.loadFromFile("./snake.png");
    tail.setTextureRect(IntRect(0, 16, 16, 16));
    tail.setScale(1, c);
    tail.setPosition(400, 316);
    snake.setPosition(400, 300);
    snake.setTextureRect(IntRect(0, 0, 16, 16));
    snake.setScale(3, 3);
    apple.setTextureRect(IntRect(32, 48, 16, 16));
    apple.setScale(2, 2);
    apple.setPosition(randomx, randomy);
    grass.setScale(64, 45);
    grass.setTextureRect(IntRect(48, 48, 16, 16));
    Text score_;
    Font font;
    font.loadFromFile("./font.ttf");
    score_.setFont(font);
    score_.setFillColor(Color::Blue);
    score_.setOutlineColor(Color::Black);
    score_.setOutlineThickness(2);
    score_.setString("score: " + to_string(counter));
    score_.setPosition(10, 10);
    float snakex[1024] = { 0 };
    float snakey[720] = { 0 };
    RectangleShape SNAKE;
    SNAKE.setPosition(Vector2f(snakex[0], snakey[0]));
    while (window.isOpen())
    {



        Event event, event2;
        while (window.pollEvent(event))
        {
            if (event.type == Event::Closed)
            {
                window.close();
            }
        }
        if (snake.getPosition().y < 0 || snake.getPosition().x < 0 || snake.getPosition().y>720 || snake.getPosition().x>1024)
        {

            snake.setPosition(512, 360);
            dir = stop;
            counter = 0;
            score_.setString("score: " + to_string(counter));
        }
        if (Keyboard::isKeyPressed(Keyboard::W) && dir != down || Keyboard::isKeyPressed(Keyboard::Up) && dir != down)
        {
            snake.setTextureRect(IntRect(0, 0, 16, 16));
            dir = up;
        }if (Keyboard::isKeyPressed(Keyboard::A) && dir != right || Keyboard::isKeyPressed(Keyboard::Left) && dir != right)
        {
            snake.setTextureRect(IntRect(48, 0, 16, 16));

            dir = left;
        }
        if (Keyboard::isKeyPressed(Keyboard::D) && dir != left || Keyboard::isKeyPressed(Keyboard::Right) && dir != left)
        {
            snake.setTextureRect(IntRect(16, 0, 16, 16));

            dir = right;
        }
        if (Keyboard::isKeyPressed(Keyboard::S) && dir != up || Keyboard::isKeyPressed(Keyboard::Down) && dir != up)
        {
            snake.setTextureRect(IntRect(32, 0, 16, 16));
            dir = down;
        }
        switch (dir)
        {
        case up:
            snake.move(0, -y);

            break;
        case down:
            snake.move(0, y);

            break;
        case right:
            snake.move(x, 0);

            break;
        case left:
            snake.move(-x, 0);
            break;
        default:
            break;
        }
        if (snake.getGlobalBounds().intersects(apple.getGlobalBounds()))
        {
            counter++;
            score_.setString("score: " + to_string(counter));
            cout << "score :\t" << counter << "\n";
            visible = false;
        }
        if (max < counter)
        {
            max = counter;
        }
        window.clear();
        window.draw(grass);
        window.draw(snake);
        apple.setPosition(randomx, randomy);
        if (visible)
        {
            window.draw(apple);
        }
        if (visible == false)
        {
            visible = true;
            srand(time(NULL));
            randomx = (rand() % 40) * 20;
            randomy = (rand() % 30) * 20;
            apple.setPosition(randomy, randomx);

        }

        window.display();
        deltatime = clock.restart().asSeconds() * 100;
    }
    cout << endl << "High Score; " << max;
    return 0;
}
